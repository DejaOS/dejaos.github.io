# JavaScript 引擎

---

## 概述

**DejaOS** 使用 [QuickJS](https://bellard.org/quickjs/) — 一个紧凑、高效且易于嵌入的 JavaScript 引擎。它由著名的法国程序员 Fabrice Bellard 开发（他也是 FFmpeg 和 QEMU 等项目的作者），支持完整的 **ES2023** 标准，包括模块、异步生成器、代理等现代语言特性。

与 Node.js 使用的 V8 引擎相比，QuickJS 更适合在资源受限的嵌入式设备上运行。它具有占用空间小、启动快、内存使用低的特点，是嵌入式和物联网环境的理想选择。

---

## QuickJS 的核心优势

### ✅ 紧凑高效

QuickJS 具有极小的代码库和极低的内存使用，能够在仅几百 KB 的环境中流畅运行。它非常适合 RAM 和存储空间有限的设备。

### ✅ 完整 ES2023 标准支持

QuickJS 提供全面的 JavaScript 功能支持，包括：

- 模块系统（`import/export`）
- 异步函数和生成器
- 代理、BigInt、Intl、正则表达式扩展等

这意味着 DejaOS 开发者可以使用几乎所有现代 JavaScript 语法，提高开发效率和可读性。

### ✅ 强大的嵌入能力

QuickJS 原生为嵌入式集成而设计，使用简单的 C 接口将 JS 引擎嵌入到现有的 C/C++ 应用程序中，使其非常易于扩展和集成。

### ✅ 高性能

虽然不追求极致的 JIT 性能（与 V8 不同），但 QuickJS 的解释执行性能在嵌入式场景中表现出色，启动快速，响应迅速，满足绝大多数物联网应用的需求。

### ✅ 支持扩展和绑定

开发者可以自定义 C 级模块和对象，通过内置接口将底层硬件能力暴露给 JavaScript 层，实现灵活的功能封装。

---

## 在 DejaOS 中的应用场景

DejaOS 将 QuickJS 与其设备驱动模块系统（如 dxCode、dxNfc 等）结合，构建了一个轻量级、高度可扩展的嵌入式 JavaScript 平台，适用于：

- 工业控制设备（如控制板、读卡器等）
- 人机交互设备（带屏幕的设备、面板）
- 智能门禁、识别终端、人脸识别设备
- 各种需要脚本编排逻辑的物联网网关/节点

此外，QuickJS 对异步编程的出色支持使得构建高性能、响应式的网络设备成为可能。

---

## 为什么选择 QuickJS？

| 对比项目       | QuickJS           | V8 (Node.js)             |
| -------------- | ----------------- | ------------------------ |
| 启动速度       | 快速（毫秒级）    | 慢（秒级）               |
| 资源使用       | 极低（RAM < 2MB） | 高（RAM > 100MB）        |
| 兼容性         | 支持完整 ES2023   | 支持主流 JS 标准         |
| 嵌入性         | 非常强            | 复杂嵌入，依赖重         |
| 适合嵌入式开发 | ✅                | ❌                       |
| 多平台支持     | ✅                | ✅（但对有限资源不友好） |

---

## 总结

DejaOS 基于对嵌入式环境的高适应性和性能平衡的考虑，选择了 QuickJS 作为其核心 JS 引擎。QuickJS 在保持极低资源消耗的同时，提供了现代化的 JavaScript 开发体验，即使在性能受限的设备上也能稳定运行和高效开发。

这不仅降低了嵌入式开发的门槛，也为 JavaScript 开发者进入物联网领域打开了新的大门。
